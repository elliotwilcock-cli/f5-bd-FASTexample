{
    "class": "ADC",
    "schemaVersion": "3.11.0",
    "id": "urn:uuid:883f3767-fdad-4a40-b7a8-52df9b8e9347",
    "label": "Converted Declaration",
    "remark": "Auto-generated by Project Charon",
    "Common": {
        "class": "Tenant",
        "Shared": {
            "class": "Application",
            "template": "shared",
            "ExchangeVS_ad_pool3": {
                "loadBalancingMode": "least-connections-member",
                "monitors": [
                    {
                        "use": "/Common/Shared/ExchangeVS_ad_http_monitor"
                    }
                ],
                "class": "Pool"
            },
            "ExchangeVS_as_pool3": {
                "loadBalancingMode": "least-connections-member",
                "monitors": [
                    {
                        "use": "/Common/Shared/ExchangeVS_as_http_monitor"
                    }
                ],
                "class": "Pool"
            },
            "ExchangeVS_ews_pool3": {
                "loadBalancingMode": "least-connections-member",
                "monitors": [
                    {
                        "use": "/Common/Shared/ExchangeVS_ews_http_monitor"
                    }
                ],
                "class": "Pool"
            },
            "ExchangeVS_mapi_pool3": {
                "loadBalancingMode": "least-connections-member",
                "monitors": [
                    {
                        "use": "/Common/Shared/ExchangeVS_mapi_http_monitor"
                    }
                ],
                "class": "Pool"
            },
            "ExchangeVS_owa_pool3": {
                "loadBalancingMode": "least-connections-member",
                "monitors": [
                    {
                        "use": "/Common/Shared/ExchangeVS_owa_http_monitor"
                    }
                ],
                "class": "Pool"
            },
            "ExchangeVS_combined_pool_irule3": {
                "class": "iRule",
                "iRule": "when HTTP_REQUEST {\n    switch -glob -- [string tolower [HTTP::path]] {\n        \"/microsoft-server-activesync*\" {\n            TCP::idletime 1800\n            pool /Common/ExchangeVS_as_pool3\n            COMPRESS::disable\n            CACHE::disable\n            return\n        }\n        \"/owa*\" {\n            \n            pool /Common/ExchangeVS_owa_pool3\n            return\n        }\n        \"/ecp*\" {\n            \n            pool /Common/ExchangeVS_owa_pool3\n            return\n        }\n        \"/ews*\" {\n            pool /Common/ExchangeVS_ews_pool3\n            COMPRESS::disable\n            CACHE::disable\n            return\n        }\n        \"/oab*\" {\n            pool /Common/ExchangeVS_ews_pool3\n            persist none\n            return\n        }\n        \"/mapi*\" {\n            pool /Common/ExchangeVS_mapi_pool3\n            COMPRESS::disable\n            CACHE::disable\n            return\n         }\n        \"/rpc/rpcproxy.dll*\" {\n            \n            COMPRESS::disable\n            CACHE::disable\n            return\n        }\n        \"/autodiscover*\" {\n            pool /Common/ExchangeVS_ad_pool3\n            persist none\n            return\n        }\n        default {\n            pool /Common/ExchangeVS_owa_pool3\n        }\n    }\n}\nwhen HTTP_RESPONSE {\n    if { ( [HTTP::header exists \"WWW-Authenticate\"] &&\n        [string tolower [HTTP::header values \"WWW-Authenticate\"]] contains \"negotiate\" ) ||\n        ( [HTTP::header exists \"Persistent-Auth\"] &&\n        [string tolower [HTTP::header \"Persistent-Auth\"]] contains \"true\" ) } {\n        ONECONNECT::reuse disable\n        ONECONNECT::detach disable\n        NTLM::disable\n   }\n   if {[HTTP::header exists \"Transfer-Encoding\"]} {\n        HTTP::payload rechunk\n   }\n}"
            },
            "ExchangeVS_owa_redirect_irule3": {
                "class": "iRule",
                "iRule": "priority 900\nwhen HTTP_REQUEST {\n    if { ([HTTP::uri] == \"/\") } {\n        HTTP::redirect https://[HTTP::host]/owa/\n    }\n}"
            },
            "ExchangeVS_combined_http": {
                "layer4": "tcp",
                "translateServerAddress": true,
                "translateServerPort": true,
                "class": "Service_TCP",
                "profileTCP": {
                    "bigip": "/Common/tcp"
                },
                "virtualAddresses": [
                    "100.1.1.100"
                ],
                "virtualPort": 80,
                "persistenceMethods": [],
                "snat": "auto"
            },
            "ExchangeVS_combined_https": {
                "layer4": "tcp",
                "iRules": [
                    {
                        "use": "/Common/Shared/ExchangeVS_owa_redirect_irule3"
                    },
                    {
                        "use": "/Common/Shared/ExchangeVS_combined_pool_irule3"
                    }
                ],
                "translateServerAddress": true,
                "translateServerPort": true,
                "class": "Service_HTTPS",
                "profileHTTPAcceleration": {
                    "use": "/Common/Shared/ExchangeVS_caching_profile"
                },
                "serverTLS": "ExchangeVS_clientssl",
                "profileHTTP": {
                    "use": "/Common/Shared/ExchangeVS_http_profile"
                },
                "profileTCP": {
                    "egress": {
                        "use": "/Common/Shared/ExchangeVS_lan-optimized_tcp_profile"
                    },
                    "ingress": {
                        "use": "/Common/Shared/ExchangeVS_wan-optimized_tcp_profile"
                    }
                },
                "profileMultiplex": {
                    "use": "/Common/Shared/ExchangeVS_oneconnect"
                },
                "profileHTTPCompression": {
                    "use": "/Common/Shared/ExchangeVS_wan-optimized-compression_profile"
                },
                "virtualAddresses": [
                    "100.1.1.100"
                ],
                "virtualPort": 443,
                "persistenceMethods": [],
                "snat": "auto"
            },
            "ExchangeVS_ad_http_monitor": {
                "adaptive": false,
                "interval": 10,
                "dscp": 0,
                "receive": "200 OK",
                "send": "GET /autodiscover/healthcheck.htm HTTP/1.1\\r\\nHost: f5.bd.com\\r\\nConnection: Close\\r\\n\\r\\n",
                "timeUntilUp": 0,
                "timeout": 31,
                "class": "Monitor",
                "monitorType": "http",
                "targetAddress": "",
                "targetPort": 0
            },
            "ExchangeVS_as_http_monitor": {
                "adaptive": false,
                "interval": 10,
                "dscp": 0,
                "receive": "200 OK",
                "send": "GET /Microsoft-Server-Activesync/healthcheck.htm HTTP/1.1\\r\\nHost: f5.bd.com\\r\\nConnection: Close\\r\\n\\r\\n",
                "timeUntilUp": 0,
                "timeout": 31,
                "class": "Monitor",
                "monitorType": "http",
                "targetAddress": "",
                "targetPort": 0
            },
            "ExchangeVS_ews_http_monitor": {
                "adaptive": false,
                "interval": 10,
                "dscp": 0,
                "receive": "200 OK",
                "send": "GET /EWS/healthcheck.htm HTTP/1.1\\r\\nHost: f5.bd.com\\r\\nConnection: Close\\r\\n\\r\\n",
                "timeUntilUp": 0,
                "timeout": 31,
                "class": "Monitor",
                "monitorType": "http",
                "targetAddress": "",
                "targetPort": 0
            },
            "ExchangeVS_mapi_http_monitor": {
                "adaptive": false,
                "interval": 10,
                "dscp": 0,
                "receive": "200 OK",
                "send": "GET /mapi/healthcheck.htm HTTP/1.1\\r\\nHost: f5.bd.com\\r\\nConnection: Close\\r\\n\\r\\n",
                "timeUntilUp": 0,
                "timeout": 31,
                "class": "Monitor",
                "monitorType": "http",
                "targetAddress": "",
                "targetPort": 0
            },
            "ExchangeVS_owa_http_monitor": {
                "adaptive": false,
                "interval": 10,
                "dscp": 0,
                "receive": "200 OK",
                "send": "GET /owa/healthcheck.htm HTTP/1.1\\r\\nHost: f5.bd.com\\r\\nConnection: Close\\r\\n\\r\\n",
                "timeUntilUp": 0,
                "timeout": 31,
                "class": "Monitor",
                "monitorType": "http",
                "targetAddress": "",
                "targetPort": 0
            },
            "certificate_default": {
                "class": "Certificate",
                "certificate": {
                    "bigip": "/Common/default.crt"
                },
                "privateKey": {
                    "bigip": "/Common/default.key"
                }
            },
            "ExchangeVS_clientssl": {
                "certificates": [
                    {
                        "certificate": "certificate_default"
                    }
                ],
                "class": "TLS_Server"
                //"tls1_0Enabled": true,
               // "tls1_1Enabled": true,
                //"tls1_2Enabled": true,
               //"tls1_3Enabled": false,
                //"singleUseDhEnabled": false,
                //"insertEmptyFragmentsEnabled": true
            },
            "ExchangeVS_http_profile": {
                "xForwardedFor": true,
                "proxyType": "reverse",
                "rewriteRedirects": "all",
                "class": "HTTP_Profile"
            },
            "ExchangeVS_wan-optimized-compression_profile": {
                "contentTypeIncludes": [
                    "application/(xml|x-javascript)"
                ],
                "class": "HTTP_Compress"
            },
            "ExchangeVS_oneconnect": {
                "sourceMask": "255.255.255.255",
                "class": "Multiplex_Profile"
            },
            "ExchangeVS_lan-optimized_tcp_profile": {
                "idleTimeout": 2100,
                "class": "TCP_Profile"
            },
            "ExchangeVS_wan-optimized_tcp_profile": {
                "idleTimeout": 2100,
                "class": "TCP_Profile"
            },
            "ExchangeVS_caching_profile": {
                "uriExcludeList": [
                    "/owa/ev.owa",
                    "oab.xml"
                ],
                "uriIncludeList": [
                    ".*"
                ],
                "parentProfile": {
                    "bigip": "/Common/optimized-caching"
                },
                "class": "HTTP_Acceleration_Profile"
            }
        }
    }
}