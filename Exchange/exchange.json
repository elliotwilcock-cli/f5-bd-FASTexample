{
    "class":"ADC",
    "schemaVersion":"3.11.0",
    "id":"urn:uuid:2c8b29bb-f318-4631-961a-94baea550b36",
    "label":"Exchange single VIP application",
    "remark":"This is Exchange 2016 Application objects for tenant",
    "myapps":{
       "class":"Tenant",
       "mail.aserracorp.com":{
          "class":"Application",
          "template":"https",
          "ExchangeVS_ad_pool3":{
             "loadBalancingMode":"least-connections-member",
             "members":[
                {
                   "addressDiscovery":"static",
                   "servicePort":443,
                   "serverAddresses":[
                      "172.16.60.107"
                   ]
                }
             ],
             "monitors":[
                {
                   "use":"/myapps/mail.aserracorp.com/ExchangeVS_ad_http_monitor"
                }
             ],
             "class":"Pool"
          },
          "ExchangeVS_as_pool3":{
             "loadBalancingMode":"least-connections-member",
             "members":[
                {
                   "addressDiscovery":"static",
                   "servicePort":443,
                   "serverAddresses":[
                      "172.16.60.107"
                   ]
                }
             ],
             "monitors":[
                {
                   "use":"/myapps/mail.aserracorp.com/ExchangeVS_as_http_monitor"
                }
             ],
             "class":"Pool"
          },
          "ExchangeVS_ews_pool3":{
             "loadBalancingMode":"least-connections-member",
             "members":[
                {
                   "addressDiscovery":"static",
                   "servicePort":443,
                   "serverAddresses":[
                      "172.16.60.107"
                   ]
                }
             ],
             "monitors":[
                {
                   "use":"/myapps/mail.aserracorp.com/ExchangeVS_ews_http_monitor"
                }
             ],
             "class":"Pool"
          },
          "ExchangeVS_mapi_pool3":{
             "loadBalancingMode":"least-connections-member",
             "members":[
                {
                   "addressDiscovery":"static",
                   "servicePort":443,
                   "serverAddresses":[
                      "172.16.60.107"
                   ]
                }
             ],
             "monitors":[
                {
                   "use":"/myapps/mail.aserracorp.com/ExchangeVS_mapi_http_monitor"
                }
             ],
             "class":"Pool"
          },
          "ExchangeVS_owa_pool3":{
             "loadBalancingMode":"least-connections-member",
             "members":[
                {
                   "addressDiscovery":"static",
                   "servicePort":443,
                   "serverAddresses":[
                      "172.16.60.107"
                   ]
                }
             ],
             "monitors":[
                {
                   "use":"/myapps/mail.aserracorp.com/ExchangeVS_owa_http_monitor"
                }
             ],
             "class":"Pool"
          },
          "ExchangeVS_combined_pool_irule3":{
             "class":"iRule",
             "iRule":"when HTTP_REQUEST {\n    switch -glob -- [string tolower [HTTP::path]] {\n        \"/microsoft-server-activesync*\" {\n            TCP::idletime 1800\n            pool /myapps/mail.aserracorp.com/ExchangeVS_as_pool3\n            COMPRESS::disable\n            CACHE::disable\n            return\n        }\n        \"/owa*\" {\n            \n            pool /myapps/mail.aserracorp.com/ExchangeVS_owa_pool3\n            return\n        }\n        \"/ecp*\" {\n            \n            pool /myapps/mail.aserracorp.com/ExchangeVS_owa_pool3\n            return\n        }\n        \"/ews*\" {\n            pool /myapps/mail.aserracorp.com/ExchangeVS_ews_pool3\n            COMPRESS::disable\n            CACHE::disable\n            return\n        }\n        \"/oab*\" {\n            pool /myapps/mail.aserracorp.com/ExchangeVS_ews_pool3\n            persist none\n            return\n        }\n        \"/mapi*\" {\n            pool /myapps/mail.aserracorp.com/ExchangeVS_mapi_pool3\n            COMPRESS::disable\n            CACHE::disable\n            return\n         }\n        \"/rpc/rpcproxy.dll*\" {\n            \n            COMPRESS::disable\n            CACHE::disable\n            return\n        }\n        \"/autodiscover*\" {\n            pool /myapps/mail.aserracorp.com/ExchangeVS_ad_pool3\n            persist none\n            return\n        }\n        default {\n            pool /myapps/mail.aserracorp.com/ExchangeVS_owa_pool3\n        }\n    }\n}\nwhen HTTP_RESPONSE {\n    if { ( [HTTP::header exists \"WWW-Authenticate\"] &&\n        [string tolower [HTTP::header values \"WWW-Authenticate\"]] contains \"negotiate\" ) ||\n        ( [HTTP::header exists \"Persistent-Auth\"] &&\n        [string tolower [HTTP::header \"Persistent-Auth\"]] contains \"true\" ) } {\n        NTLM::disable\n   }\n   if {[HTTP::header exists \"Transfer-Encoding\"]} {\n        HTTP::payload rechunk\n   }\n}"
          },
          "ExchangeVS_owa_redirect_irule3":{
             "class":"iRule",
             "iRule":"priority 900\nwhen HTTP_REQUEST {\n    if { ([HTTP::uri] == \"/\") } {\n        HTTP::redirect https://[HTTP::host]/owa/\n    }\n}"
          },
          "servertls":{
             "class":"TLS_Client",
             "trustCA":"none"
          },
          "webtls":{
             "class":"TLS_Server",
             "certificates":[
                {
                   "certificate":"webcert"
                }
             ]
          },
          "webcert":{
             "class":"Certificate",
             "remark":"in practice we recommend using a passphrase",
             "certificate":"-----BEGIN CERTIFICATE-----\nMIIFWTCCBEGgAwIBAgITfQAAAEODziK48fSSRAAAAAAAQzANBgkqhkiG9w0BAQUF\nADBOMRMwEQYKCZImiZPyLGQBGRYDY29tMRowGAYKCZImiZPyLGQBGRYKYXNlcnJh\nY29ycDEbMBkGA1UEAxMSYXNlcnJhY29ycC1EQy1DQS0xMB4XDTIwMDgxNDE4NTUx\nNFoXDTIyMDgxNDE4NTUxNFowHjEcMBoGA1UEAxMTbWFpbC5hc2VycmFjb3JwLmNv\nbTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAOIxEn3SCBJDtf326uc1\nYofza/s3U7ilYr72hDBiYOA2tpFegzzR0miE7WpJlenMEh5DsjRXI5P02/G5O00W\nNHon8mAR0KmbzgatgiA37xgXnI55aH3mgtJS5FwaeO94Gagv7LBrInC4Ym80pM8d\nEPohDxF5mTO02m2+hoVn5gXkbnuA2KeqPOK1vw1x29JUfsHCONFYBoWsTqGBscrM\ncjIjvAoOsl7EEDbPOeoydIiu55XhOaiIp1Vm/jYo0hFfEYTOx2Qz2dA0j0rgbdKh\ndwtcBonZHNsv3DYG0PnTWT4SK4glgd4vElW7+Hp+gp755QMjrTkV1OM3lV0v0cEQ\nCi0CAwEAAaOCAl4wggJaMDsGCSsGAQQBgjcVBwQuMCwGJCsGAQQBgjcVCIGD0GmD\nm+cHhvmXGKCGN4PxgTR5gv66PIKFaQIBZAIBAzATBgNVHSUEDDAKBggrBgEFBQcD\nATAOBgNVHQ8BAf8EBAMCBaAwGwYJKwYBBAGCNxUKBA4wDDAKBggrBgEFBQcDATAd\nBgNVHQ4EFgQU0JRapN6/FyumdxT5iomav7LL/4wwHwYDVR0jBBgwFoAUETMyELiX\nqbKOY7RYFjazS0uPV9Awgc4GA1UdHwSBxjCBwzCBwKCBvaCBuoaBt2xkYXA6Ly8v\nQ049YXNlcnJhY29ycC1EQy1DQS0xLENOPWRjLENOPUNEUCxDTj1QdWJsaWMlMjBL\nZXklMjBTZXJ2aWNlcyxDTj1TZXJ2aWNlcyxDTj1Db25maWd1cmF0aW9uLERDPWFz\nZXJyYWNvcnAsREM9Y29tP2NlcnRpZmljYXRlUmV2b2NhdGlvbkxpc3Q/YmFzZT9v\nYmplY3RDbGFzcz1jUkxEaXN0cmlidXRpb25Qb2ludDCBxwYIKwYBBQUHAQEEgbow\ngbcwgbQGCCsGAQUFBzAChoGnbGRhcDovLy9DTj1hc2VycmFjb3JwLURDLUNBLTEs\nQ049QUlBLENOPVB1YmxpYyUyMEtleSUyMFNlcnZpY2VzLENOPVNlcnZpY2VzLENO\nPUNvbmZpZ3VyYXRpb24sREM9YXNlcnJhY29ycCxEQz1jb20/Y0FDZXJ0aWZpY2F0\nZT9iYXNlP29iamVjdENsYXNzPWNlcnRpZmljYXRpb25BdXRob3JpdHkwDQYJKoZI\nhvcNAQEFBQADggEBAHF/co/AP1OXkGuwxMIxapLLnS0VI2y20X+3zosfbnjh4OJ9\nh7KM6+v2g4bdgEGwu1vFeZioCIKxqSgGPwwNNO5i5iPHJp3hf/eZHe/iKUqviG4L\nvdx8+Djy/vaWnyqDUitHxUMmMCJUtwczuTOVbKyKYWp14xjI9xwOVjiCId+h4KJR\n8kUJKcdRqGTOps4qfdGLJt3nSHlXRAMBeHN146LePydRF77NoFnCbrjkRB44Sdcx\nbkv2IHI4ksajY34UdHTlTPM5AKfwL1+fiwQGy+kT0mY9uEHnOX4pE/AXUNAVFyfx\nB1fGVHNPbzcu2JpRY4/3gp1HCoc7dxfMDyLqLRI=\n-----END CERTIFICATE-----",
             "privateKey":"-----BEGIN PRIVATE KEY-----\nMIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQDiMRJ90ggSQ7X9\n9urnNWKH82v7N1O4pWK+9oQwYmDgNraRXoM80dJohO1qSZXpzBIeQ7I0VyOT9Nvx\nuTtNFjR6J/JgEdCpm84GrYIgN+8YF5yOeWh95oLSUuRcGnjveBmoL+ywayJwuGJv\nNKTPHRD6IQ8ReZkztNptvoaFZ+YF5G57gNinqjzitb8NcdvSVH7BwjjRWAaFrE6h\ngbHKzHIyI7wKDrJexBA2zznqMnSIrueV4TmoiKdVZv42KNIRXxGEzsdkM9nQNI9K\n4G3SoXcLXAaJ2RzbL9w2BtD501k+EiuIJYHeLxJVu/h6foKe+eUDI605FdTjN5Vd\nL9HBEAotAgMBAAECggEAISI0xhHoanCDw3jnmR3fWfCPs/mQqImFiQQIgiPvHU5h\nI7NMwIcwmMHxcJ095MUm2aBrWt0cPOtkn/3/0KoniXC6QatqaGYGjJY0a8QgdeQu\nOUqnQrDBH3koCCaSlOsAFdHgt0kXqZvA7kRaaMJ7vwBCZPoYiz6mCTxxwoS2k8xy\nHPTAYGvELE05kbXHKa/ji9quJstkdBQHbVsQA8kpOyKbf/Ob1k7mM4T35t1pPiWV\nakBKYqFuhnMDhIO0msPkNBrMYKoZ+9X1UxxDiqTvMTzqaCXlYdp0Ou5gQYZ/WSgW\nTps9/LGv83XOTdC/AbjQGF1zmjRjOcOdno1Vn/isCwKBgQD89QLUTvc8jHBFM2aW\nvdk714Lb//X2dyswDh0vZsXHzdZMZGImshUyhZ86PY61YhYMdVx9a2wUVqsJdiQf\nmwcUgWvoRr455Ltsh9s2qjFbyUOFJMABCdoFRU5zlJl/ofhRDKI2T1coxi1ztryA\nYXCf+6vyCxDHmIBvhbdvvQAt9wKBgQDk6aLo4VC1Cek24HmC5cvl8Pc+YQztvzZ/\nlOLdvEOml8XG7/n7IxVm19FfEXp6VSgOZ/XuASBdk7HtDl3ZE2KyFfNGIc5+p8hW\nykjYhaVVBqLXZo6AWf69ud1uKGJ8/nKanuJgHWjcjFUHMv15hOd7Vaf9Lcw7iA1K\nqcmu8/qP+wKBgCcjUZi/zwkTQZuzZEAWh7H2mkynwcqsjYYV6PYYlKlhc7LGJVmP\nXDBA9G3ycE4oKvkqf3D4WfSbpEMGgHhTaDkH/UYnC++xMD6OlqBSnOhyr3u+P+bp\nO05tdsHzT/yrdtwzdDWq+PVaFFY/A9NpQB/AtM3yYFpBgj2/Fq63M3vpAoGALu1C\na1E9VU+p0okj/9SR/xpt5QjKOLbZOkBQXbppd+5nKggqC/S+P24AyudvX0Kzyng/\nb0Il22kasYkfbg/OTMm5LGhjx40nwbsIQfLr2MlaeqPYlLFeSpCetyVqQ0t6PP5T\nU/bTd1sBV095rP604ZDGtl08H/wdFXBHGymC9R8CgYEAsHlPfmNv3YUMHH/K9Uj1\nsYl96rkYcxKD6prrAVVoJFknKwGwS/4ydtkp90krV/RkR92kPO7c0tL9Q/QcJ7Bu\nOQowe2bl/Ggop8BT8Bjps2E4tExPJjQrU1qX3q1h8DLWBaYAPNK+WSBjO0vFExPu\nphQN+5tz3Is1gkkX2eU8ueM=\n-----END PRIVATE KEY-----\n"
          },
          "serviceMain":{
             "layer4":"tcp",
             "translateServerAddress":true,
             "serverTLS":"webtls",
             "clientTLS":"servertls",
             "translateServerPort":true,
             "class":"Service_HTTPS",
             "iRules":[
                {
                   "use":"/myapps/mail.aserracorp.com/ExchangeVS_owa_redirect_irule3"
                },
                {
                   "use":"/myapps/mail.aserracorp.com/ExchangeVS_combined_pool_irule3"
                }
             ],
             "profileHTTPAcceleration":{
                "use":"ExchangeVS-cache-optimize"
             },
             "profileHTTP":{
                "use":"ExchangeVS-http"
             },
             "profileHTTPCompression":{
                "use":"ExchangeVS-httpcompression"
             },
             "profileTCP":{
                "egress":{
                   "use":"ExchangeVS-tcp-lan"
                },
                "ingress":{
                   "use":"ExchangeVS-tcp-wan"
                }
             },
             "virtualAddresses":[
                "206.124.129.197"
             ],
             "virtualPort":443,
             "persistenceMethods":[
                
             ],
             "snat":"auto"
          },
          "ExchangeVS_ad_http_monitor":{
             "adaptive":false,
             "interval":10,
             "dscp":0,
             "receive":"200 OK",
             "send":"GET /autodiscover/healthcheck.htm HTTP/1.1\\r\\nHost: mail.aserracorp.com\\r\\nConnection: Close\\r\\n\\r\\n",
             "timeUntilUp":0,
             "timeout":31,
             "class":"Monitor",
             "monitorType":"https",
             "targetAddress":"",
             "targetPort":0
          },
          "ExchangeVS_as_http_monitor":{
             "adaptive":false,
             "interval":10,
             "dscp":0,
             "receive":"200 OK",
             "send":"GET /Microsoft-Server-Activesync/healthcheck.htm HTTP/1.1\\r\\nHost: mail.aserracorp.com\\r\\nConnection: Close\\r\\n\\r\\n",
             "timeUntilUp":0,
             "timeout":31,
             "class":"Monitor",
             "monitorType":"https",
             "targetAddress":"",
             "targetPort":0
          },
          "ExchangeVS_ews_http_monitor":{
             "adaptive":false,
             "interval":10,
             "dscp":0,
             "receive":"200 OK",
             "send":"GET /EWS/healthcheck.htm HTTP/1.1\\r\\nHost: mail.aserracorp.com\\r\\nConnection: Close\\r\\n\\r\\n",
             "timeUntilUp":0,
             "timeout":31,
             "class":"Monitor",
             "monitorType":"https",
             "targetAddress":"",
             "targetPort":0
          },
          "ExchangeVS_mapi_http_monitor":{
             "adaptive":false,
             "interval":10,
             "dscp":0,
             "receive":"200 OK",
             "send":"GET /mapi/healthcheck.htm HTTP/1.1\\r\\nHost: mail.aserracorp.com\\r\\nConnection: Close\\r\\n\\r\\n",
             "timeUntilUp":0,
             "timeout":31,
             "class":"Monitor",
             "monitorType":"https",
             "targetAddress":"",
             "targetPort":0
          },
          "ExchangeVS_owa_http_monitor":{
             "adaptive":false,
             "interval":10,
             "dscp":0,
             "receive":"200 OK",
             "send":"GET /owa/healthcheck.htm HTTP/1.1\\r\\nHost: mail.aserracorp.com\\r\\nConnection: Close\\r\\n\\r\\n",
             "timeUntilUp":0,
             "timeout":31,
             "class":"Monitor",
             "monitorType":"https",
             "targetAddress":"",
             "targetPort":0
          },
          "ExchangeVS-http":{
             "proxyType":"reverse",
             "class":"HTTP_Profile",
             "rewriteRedirects":"all"
          },
          "ExchangeVS-httpcompression":{
             "contentTypeIncludes":[
                "application/(xml|x-javascript)"
             ],
             "class":"HTTP_Compress"
          },
          "ExchangeVS-oneconnect":{
             "class":"Multiplex_Profile",
             "maxConnections":5000,
             "maxConnectionAge":3600,
             "maxConnectionReuse":20000,
             "idleTimeoutOverride":900,
             "connectionLimitEnforcement":"idle",
             "sharePools":true
          },
          "ExchangeVS-tcp-lan":{
             "idleTimeout":2100,
             "class":"TCP_Profile"
          },
          "ExchangeVS-tcp-wan":{
             "idleTimeout":2100,
             "class":"TCP_Profile"
          },
          "ExchangeVS-cache-optimize":{
             "uriExcludeList":[
                "/owa/ev.owa",
                "oab.xml"
             ],
             "uriIncludeList":[
                ".*"
             ],
             "parentProfile":{
                "bigip":"/Common/optimized-caching"
             },
             "class":"HTTP_Acceleration_Profile"
          }
       }
    }
   }
   